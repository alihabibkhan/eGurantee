<!DOCTYPE html>
<html lang="en">
<head>
    {% include 'head.html' %}
    <title>{{ 'Edit Loan Metric' if result.loan_metric else 'Add Loan Metric' }}</title>
</head>
<body>
    {% include 'navbar.html' %}
    {% import 'breadcrumbs.html' as brd %}
    {{ brd.render_Breadcrumbs([{"url": 'manage_loan_metrics', "label": "Manage Loan Metrics"}, {"url": "", "label": 'Edit Loan Metric' if result.loan_metric else 'Add Loan Metric' }]) }}

    <div class="container mt-4">
        {% include 'message_box.html' %}

        <div class="card">
            <div class="card-header">
                <h2>{{ 'Edit Loan Metric' if result.loan_metric else 'Add Loan Metric' }}</h2>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="form-group mb-3">
                        <label for="product_id">Product</label>
                        <select name="product_id" class="form-control" required>
                            <option value="" disabled>Select...</option>
                            {% for product in result.get_all_loan_products %}
                                <option value="{{ product.product_id }}" {{ 'selected' if result.loan_metric and result.loan_metric.product_id == product.product_id }}>{{ product.name }} ({{ product.gender }})</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label for="occupation_id">Occupation</label>
                        <select name="occupation_id" class="form-control" required>
                            <option value="" disabled>Select...</option>
                            {% for occupation in result.get_all_occupations %}
                                <option value="{{ occupation.occupation_id }}" {{ 'selected' if result.loan_metric and result.loan_metric.occupation_id == occupation.occupation_id }}>{{ occupation.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label for="experience_id">Experience Range</label>
                        <select name="experience_id" class="form-control" required>
                            <option value="" disabled>Select...</option>
                            {% for range in result.get_all_experience_ranges %}
                                <option value="{{ range.experience_range_id }}" {{ 'selected' if result.loan_metric and result.loan_metric.experience_id == range.experience_range_id }}>{{ range.label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group mb-3 d-none">
                        <label for="branch_id">Branch</label>
                        <select name="branch_id" class="form-control" required>
                            <option value="" disabled>Select...</option>
                            {% for branch in result.get_all_branches_info %}
                                <option value="{{ branch.branch_id }}" {{ 'selected' if result.loan_metric and result.loan_metric.branch_id == branch.id }}>{{ branch.branch_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label for="global_loan_ceiling">Global Loan Ceiling</label>
                        <input type="text" name="global_loan_ceiling" class="form-control" value="{{ result.loan_metric.global_loan_ceiling if result.loan_metric else '' }}" required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="interest_rate">Interest Rate (%)</label>
                        <input type="text" name="interest_rate" class="form-control" value="{{ result.loan_metric.interest_rate | int if result.loan_metric else '' }}" required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="repeat_increment">Repeat Increment (%)</label>
                        <input type="text" name="repeat_increment" class="form-control" value="{{ result.loan_metric.repeat_increment | int if result.loan_metric else '' }}" required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="required_paid_off">Required Paid Off (%)</label>
                        <input type="text" name="required_paid_off" class="form-control" value="{{ result.loan_metric.required_paid_off | int if result.loan_metric else '' }}" required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="is_active">Is Active</label>
                        <select name="is_active" class="form-control" required>
                            <option value="" disabled>Select...</option>
                            <option value="1" {{ 'selected' if result.loan_metric and result.loan_metric.is_active == '1' }}>Yes</option>
                            <option value="0" {{ 'selected' if result.loan_metric and result.loan_metric.is_active == '0' }}>No</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">{{ 'Update Loan Metric' if result.loan_metric else 'Add Loan Metric' }}</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>